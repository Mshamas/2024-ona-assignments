---
title: "Exercise 1"
date: "2024-03-19"
output: md_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Required Libraries

```{r libraries}
library(dplyr)
library(stringr)
library(tidyr)
library(igraph)
library(readr)
```

## Reading LinkedIn Data

```{r read-data}
linkedin_data <- read_csv("C:/Users/m_sha/Downloads/Basic_LinkedInDataExport_03-14-2024/Connections.csv", 
                          skip = 3)
```

## Analyzing Contacts by Their Current Company

```{r company-analysis}
company_contact_counts <- linkedin_data %>%
  group_by(Company) %>%
  summarise(Count = n()) %>%
  arrange(desc(Count))

print(company_contact_counts)
```

## Calculating the Total Number of Contacts

```{r total-contacts}
total_contacts <- sum(company_contact_counts$Count)
print(paste("Total contacts:", total_contacts))
```

## Preparing Data for Network Analysis

### Generating Unique Names for Nodes

```{r unique-names}
linkedin_data$NodeName <- with(linkedin_data, paste(`First Name`, substring(`Last Name`, 1, 1), sep = "_"))
```

### Adding Unique Identifiers

```{r unique-ids}
linkedin_data <- linkedin_data %>%
  mutate(NodeID = row_number())
```

### Creating Unique Nodes

```{r unique-nodes}
nodes_unique <- linkedin_data %>%
  distinct(NodeID, NodeName, Company)
```

### Preparing Data for Connections Between Nodes

```{r connections-prep}
edges_for_analysis <- linkedin_data %>%
  inner_join(nodes_unique, by = c("NodeName", "Company"))
```

### Identifying Connections Between Individuals Within the Same Company

```{r identify-connections}
connections_details <- nodes_unique %>%
  group_by(Company) %>%
  filter(n() > 1) %>%
  summarise(CombinationPairs = list(combn(NodeID, 2, simplify = FALSE))) %>%
  unnest(CombinationPairs) %>%
  ungroup() %>%
  mutate(From = sapply(CombinationPairs, `[`, 1),
         To = sapply(CombinationPairs, `[`, 2)) %>%
  select(From, To)

print(connections_details)
```

## Building and Plotting the Network Graph

```{r network-graph}
network_diagram <- graph_from_data_frame(d = connections_details, vertices = nodes_unique, directed = TRUE)
plot(network_diagram, vertex.label = V(network_diagram)$NodeName)
```
